{
    "version": "1.0.0",
    "last_updated": "2026-01-15",
    "signatures": {
        "backdoor": [
            {
                "id": "BACKDOOR_001",
                "name": "FilesMan Backdoor",
                "pattern": "FilesMan|fileMan",
                "severity": "critical",
                "description": "Known FilesMan web shell backdoor"
            },
            {
                "id": "BACKDOOR_002",
                "name": "C99 Shell",
                "pattern": "c99shell|c99_buff_prepare",
                "severity": "critical",
                "description": "C99 PHP web shell"
            },
            {
                "id": "BACKDOOR_003",
                "name": "R57 Shell",
                "pattern": "r57shell|r57_cmd",
                "severity": "critical",
                "description": "R57 PHP web shell"
            },
            {
                "id": "BACKDOOR_004",
                "name": "WSO Shell",
                "pattern": "WSO\\s+[0-9.]+|wso_version",
                "severity": "critical",
                "description": "WSO (Web Shell by oRb) backdoor"
            },
            {
                "id": "BACKDOOR_005",
                "name": "B374K Shell",
                "pattern": "b374k|B374K",
                "severity": "critical",
                "description": "B374K PHP web shell"
            }
        ],
        "malware": [
            {
                "id": "MALWARE_001",
                "name": "Pharma Hack",
                "pattern": "viagra|cialis|pharmacy(?!.*\\.(css|txt))",
                "severity": "high",
                "description": "Pharma/SEO spam injection"
            },
            {
                "id": "MALWARE_002",
                "name": "Malicious Redirect",
                "pattern": "document\\.location\\.href\\s*=\\s*['\"][^'\"]*\\.(ru|cn|tk|xyz)",
                "severity": "high",
                "description": "Malicious redirect to suspicious TLD"
            },
            {
                "id": "MALWARE_003",
                "name": "Hidden iframe",
                "pattern": "<iframe[^>]*(visibility:\\s*hidden|display:\\s*none|height:\\s*0|width:\\s*0)",
                "severity": "high",
                "description": "Hidden iframe injection"
            },
            {
                "id": "MALWARE_004",
                "name": "Encoded Malware",
                "pattern": "\\$[a-zA-Z_]+\\s*=\\s*['\"][A-Za-z0-9+/=]{500,}['\"];",
                "severity": "high",
                "description": "Large base64 encoded string (potential malware)"
            },
            {
                "id": "MALWARE_005",
                "name": "Malicious eval/create_function",
                "pattern": "(eval|create_function)\\s*\\(\\s*(gzinflate|gzuncompress|base64_decode|str_rot13)",
                "severity": "critical",
                "description": "Obfuscated code execution"
            }
        ],
        "suspicious": [
            {
                "id": "SUSPICIOUS_001",
                "name": "eval() with variable",
                "pattern": "eval\\s*\\(\\s*\\$[a-zA-Z_]",
                "severity": "medium",
                "description": "eval() with variable input - potential code injection"
            },
            {
                "id": "SUSPICIOUS_002",
                "name": "Shell execution function",
                "pattern": "\\b(shell_exec|passthru|system|popen|proc_open|pcntl_exec)\\s*\\(",
                "severity": "medium",
                "description": "Shell command execution function"
            },
            {
                "id": "SUSPICIOUS_003",
                "name": "File operations with POST/GET",
                "pattern": "(file_put_contents|fwrite|fputs)\\s*\\([^)]*\\$_(POST|GET|REQUEST)",
                "severity": "high",
                "description": "File write with user input"
            },
            {
                "id": "SUSPICIOUS_004",
                "name": "Include with variable",
                "pattern": "(include|include_once|require|require_once)\\s*\\(?\\s*\\$_(POST|GET|REQUEST)",
                "severity": "critical",
                "description": "Remote/Local file inclusion vulnerability"
            },
            {
                "id": "SUSPICIOUS_005",
                "name": "Preg_replace with /e modifier",
                "pattern": "preg_replace\\s*\\(\\s*['\"][^'\"]*\\/[a-zA-Z]*e[a-zA-Z]*['\"]",
                "severity": "high",
                "description": "preg_replace with eval modifier (code execution)"
            },
            {
                "id": "SUSPICIOUS_006",
                "name": "assert() execution",
                "pattern": "assert\\s*\\(\\s*\\$",
                "severity": "medium",
                "description": "assert() with variable - potential code execution"
            },
            {
                "id": "SUSPICIOUS_007",
                "name": "Hex encoded strings",
                "pattern": "\\\\x[0-9a-fA-F]{2}(\\\\x[0-9a-fA-F]{2}){10,}",
                "severity": "medium",
                "description": "Long hex encoded string (obfuscation)"
            },
            {
                "id": "SUSPICIOUS_008",
                "name": "chr() obfuscation",
                "pattern": "chr\\s*\\(\\s*[0-9]+\\s*\\)\\s*\\.\\s*chr\\s*\\(\\s*[0-9]+\\s*\\)\\s*\\.\\s*chr",
                "severity": "medium",
                "description": "chr() based string obfuscation"
            },
            {
                "id": "SUSPICIOUS_009",
                "name": "Gzinflate/base64 combo",
                "pattern": "gzinflate\\s*\\(\\s*base64_decode|base64_decode\\s*\\(\\s*gzinflate",
                "severity": "high",
                "description": "Compressed and encoded payload"
            },
            {
                "id": "SUSPICIOUS_010",
                "name": "WordPress user creation",
                "pattern": "wp_insert_user|wp_create_user.*\\$_(POST|GET|REQUEST)",
                "severity": "critical",
                "description": "Unauthorized user creation attempt"
            }
        ],
        "obfuscation": [
            {
                "id": "OBFUSCATION_001",
                "name": "Variable function call",
                "pattern": "\\$[a-zA-Z_]+\\s*\\(\\s*\\$[a-zA-Z_]+\\s*\\)",
                "severity": "low",
                "description": "Variable function call (common in obfuscated code)"
            },
            {
                "id": "OBFUSCATION_002",
                "name": "String concatenation obfuscation",
                "pattern": "['\"][a-z]{1,3}['\"]\\s*\\.\\s*['\"][a-z]{1,3}['\"]\\s*\\.\\s*['\"][a-z]{1,3}['\"]\\s*\\.\\s*['\"][a-z]{1,3}['\"]",
                "severity": "low",
                "description": "Excessive string concatenation"
            },
            {
                "id": "OBFUSCATION_003",
                "name": "Ionocube/Zend encoded",
                "pattern": "(ionCube|zend_loader|SourceGuardian)",
                "severity": "low",
                "description": "Commercial encoder detected (verify legitimacy)"
            }
        ]
    },
    "whitelist_patterns": [
        "PHPUnit",
        "Composer",
        "vendor/",
        "node_modules/",
        "tests/",
        "test/",
        "phpunit",
        "codeception"
    ],
    "scan_extensions": [
        "php",
        "phtml",
        "php3",
        "php4",
        "php5",
        "php7",
        "phps",
        "pht",
        "phar",
        "inc"
    ]
}
